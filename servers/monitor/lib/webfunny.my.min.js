!function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t){let r=my;var n,a;a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",(n=r).btoa=n.btoa||function(e){for(var t,r,n,o,s="",i=0,c=(e=String(e)).length%3;i<e.length;){if((r=e.charCodeAt(i++))>255||(n=e.charCodeAt(i++))>255||(o=e.charCodeAt(i++))>255)throw new TypeError("Failed to execute 'btoa' on 'Window': The string to be encoded contains characters outside of the Latin1 range.");s+=a.charAt((t=r<<16|n<<8|o)>>18&63)+a.charAt(t>>12&63)+a.charAt(t>>6&63)+a.charAt(63&t)}return c?s.slice(0,c-3)+"===".substring(c):s};class o{static getStorageSync(e){return"undefined"!=typeof my?my.getStorageSync({key:e}).data:r.getStorageSync(e)}static setStorageSync(e,t){"undefined"!=typeof my?my.setStorageSync({key:e,data:t}):r.setStorageSync(e,t)}}var s=o.getStorageSync("WF_CONFIG"),i=s||{s:!0,ia:[""],wc:40,pv:{s:"webfunny-pageview-switch",ia:[""]},je:{s:"webfunny-jserror-switch",ia:[""]},hl:{s:"webfunny-http-switch",ia:[""],uh:!1,rl:500,sl:500},rl:{s:"webfunny-resource-switch",ia:[""]},bl:{s:"webfunny-behavior-switch"},lc:{s:"webfunny-location-switch"}},c="webfunnyVersionFlag",u="&&&www.webfunny.cn&&&",l="http://"+u,f=l+"/wfMonitor/upMog",g="CUSTOMER_PV",h="CUS_LEAVE",d="HTTP_LOG",p="JS_ERROR",v="LAST_BROWSE_DATE",y="WM_PAGE_ENTRY_TIME",m="WM_VISIT_PAGE_COUNT",S="WEBFUNNY_COOKIE",T=[p,g,d];const w={[g]:[],STAY_TIME:[],[h]:[],LOAD_PAGE:[],[d]:[],HTTP_ERROR:[],[p]:[],SCREEN_SHOT:[],ELE_BEHAVIOR:[],RESOURCE_LOAD:[],CUSTOMIZE_BEHAVIOR:[]};var C=function(e){var t=new O("reload",0,"o","");t.simpleUrl=e,t.completeUrl=e,t.handleLogInfo(g,t)};class b{static getCurrentPages(){var e="";try{var t=getCurrentPages();t.length>0&&(e=getCurrentPages()[t.length-1].route)}catch(t){e=""}return e}static getUuid(){var e=b.formatDate((new Date).getTime(),"yMdhms");return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})+"-"+e}static getCustomerKey(){var e=b.getUuid(),t=o.getStorageSync("monitorCustomerKey");return t||(o.setStorageSync("monitorCustomerKey",e),t=e),t}static isTodayBrowse(e){var t=o.getStorageSync(e),r=(new Date).getFullYear()+"-"+((new Date).getMonth()+1)+"-"+(new Date).getDate();return t&&r==t?!(!t||r!=t):(o.setStorageSync(e,r),!1)}static formatDate(e,t){var r=new Date(e).getFullYear(),n=new Date(e).getMonth()+1,a=new Date(e).getDate(),o=new Date(e).getHours(),s=new Date(e).getMinutes(),i=new Date(e).getSeconds();return n=n>9?n:"0"+n,a=a>9?a:"0"+a,o=o>9?o:"0"+o,s=s>9?s:"0"+s,i=i>9?i:"0"+i,t.replace("y",r).replace("M",n).replace("d",a).replace("h",o).replace("m",s).replace("s",i)}static getPageKey(){var e=o.getStorageSync("monitorPageKey"),t=b.getUuid();return e&&/^[0-9a-z]{8}(-[0-9a-z]{4}){3}-[0-9a-z]{12}-\d{13}$/.test(e)||(e=t),e}static setPageKey(){o.setStorageSync("monitorPageKey",b.getUuid())}static ajax(e,t,n,a,o){r.request({method:e,url:t,data:n,header:{"Content-Type":"application/json"},success:e=>{"function"==typeof a&&a(e)},fail:e=>{"function"==typeof o&&o(e)}})}static uploadCusBehavior(e,t,n){var a={webMonitorId:b.getWebMonitorId(),userId:b.getCusInfo("userId"),uploadType:"CUSTOMIZE_BEHAVIOR",happenTime:(new Date).getTime(),behaviorType:b.b64EncodeUnicode(e),behaviorResult:b.b64EncodeUnicode(t),description:b.b64EncodeUnicode(n)};r.request({method:"POST",url:l+"/server/upMyLog",data:{logs:[a]},header:{"Content-Type":"application/json"}})}static checkReqResLen(e="",t="",r){var n=e?JSON.stringify(e):"no param",a=t?JSON.stringify(t):"no result",o=parseInt(r.rl)||500,s=parseInt(r.sl)||500;return n&&n.length>o&&(n="too long"),a&&a.length>s&&(a="too long"),{requestText:n,responseText:a}}static encryptObj(e){if(e instanceof Array){for(var t=[],r=0;r<e.length;++r)t[r]=b.encryptObj(e[r]);return t}if(e instanceof Object){t={};for(var r in e)t[r]=b.encryptObj(e[r]);return t}return(e+="").length>50&&(e=e.substring(0,10)+"****"+e.substring(e.length-9,e.length)),e}static getDevice(){return r.getSystemInfoSync()}static b64EncodeUnicode(e){var t=encodeURIComponent(e);try{return r.btoa(encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode("0x"+t)}))}catch(e){return t}}static utf8_encode(e){if(!e)return"";var t="";e=e.replace(/\r\n/g,"\n");for(var r=0;r<e.length;r++){var n=e.charCodeAt(r);n<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t}static setWfCookie(e,t,r){var n={data:t,expires:r},a=o.getStorageSync(S);if(a)a[e]=n,o.setStorageSync(S,a);else{var s={};s[e]=n,o.setStorageSync(S,s)}}static getWfCookie(e){var t=o.getStorageSync(S);if(t){var r=t[e];if(!r)return"";var n=parseInt(r.expires,10);return(new Date).getTime()>n?(delete t[e],o.setStorageSync(S,t),""):r.data}return""}static getCusInfo(e){if(!e)return"";var t=o.getStorageSync("wmUserInfo"),r=(t?JSON.parse(t):{})[e];return r||""}static getWebMonitorId(){var e="jeffery_webmonitor";if(-1!==e.indexOf("_pro")){var t=b.getCusInfo("env");t&&(e=e.replace("_pro","_"+t))}return e}static checkIgnore(e,t){if(!t)return!0;for(var r=t.replace(/ /g,""),n=i[e].ia||[],a=!0,o=0;o<n.length;o++){var s=n[o].replace(/ /g,"");if(s&&-1!=r.indexOf(s)){a=!1;break}}return a}}class x{constructor(){var e=b.getCurrentPages();this.wmVersion=c,this.happenTime=(new Date).getTime(),this.webMonitorId=b.getWebMonitorId(),this.simpleUrl=e,this.completeUrl=e,this.customerKey=b.getCustomerKey(),this.userId=b.getCusInfo("userId"),this.projectVersion=b.getCusInfo("projectVersion")||"",this.firstUserParam=b.b64EncodeUnicode(b.getCusInfo("userTag")||""),this.secondUserParam=b.b64EncodeUnicode(b.getCusInfo("secondUserParam")||"")}handleLogInfo(e,t){var r=w[e],n=r||[];n.push(t),w[e]=n}}class O extends x{constructor(e,t,r,n){super();var a=b.getDevice();this.uploadType=g,this.pageKey=b.getPageKey(),this.deviceName=a.model,this.os=a.system,this.browserName=a.platform,this.browserVersion=a.version,this.deviceSize=a.screenWidth+"×"+a.screenHeight,this.monitorIp="",this.country="",this.province="",this.city="",this.loadType=e,this.loadTime=t,this.newStatus=r,this.referrer=(n||"").split("?")[0].replace("#","")}}class I{constructor(e){var t=b.getCurrentPages();this.uploadType=h,this.webMonitorId=b.getWebMonitorId(),this.leaveType=e,this.happenTime=(new Date).getTime(),this.simpleUrl=t,this.customerKey=b.getCustomerKey()}}class _ extends x{constructor(e,t,r,n,a){super();var o=b.getDevice();this.uploadType=e,this.infoType=t,this.pageKey=b.getPageKey(),this.deviceName=o.model,this.os=o.system,this.browserName=o.platform,this.browserVersion=o.version,this.monitorIp="",this.country="china",this.province="",this.city="",this.simpleErrorMessage=b.b64EncodeUnicode(r),this.errorMessage=b.b64EncodeUnicode(n),this.errorStack=b.b64EncodeUnicode(a),this.browserInfo=""}}class E extends x{constructor(e,t,r,n,a,o,s,i,c){super(),this.uploadType=e,this.method=t?t.toLowerCase():"get",this.httpUrl=b.b64EncodeUnicode(r),this.status=n,this.statusText=a,this.statusResult=o,this.requestText=b.b64EncodeUnicode(s),this.responseText=b.b64EncodeUnicode(i),this.loadTime=c}}var P="";function D(){if(getCurrentPages().length){var e=b.getCurrentPages();P!=e&&(!function(){var e=b.getCurrentPages();if(e){var t=b.isTodayBrowse(v),r=(new Date).getTime();o.setStorageSync(y,r);var n=null,a=b.formatDate(r,"y-M-d"),s=e,i=o.getStorageSync(m);if(i){var c=i.split("$$$"),u=c[0],l=c[1],h=parseInt(c[2],10);a==l?s!=u&&1==h&&(o.setStorageSync(m,s+"$$$"+a+"$$$2"),n=new I(2)):(o.setStorageSync(m,s+"$$$"+a+"$$$1"),n=new I(1))}else o.setStorageSync(m,s+"$$$"+a+"$$$1"),n=new I(1);var d=o.getStorageSync("monitorCustomerKey");if(d){var p="",S=d?d.match(/\d{14}/g):[];if(S&&S.length>0){var T=S[0].match(/\d{2}/g),w=T[0]+T[1]+"-"+T[2]+"-"+T[3]+" "+T[4]+":"+T[5]+":"+T[6],C=new Date(w).getTime();p=(new Date).getTime()-C>300?0==t?"o_uv":"o":"n_uv"}}else p="n_uv",b.getCustomerKey();var x=new O("reload",0,p,"");if("n_uv"===p||"o_uv"===p){var _=[x,n];b.ajax("POST",f,_)}else x.handleLogInfo(g,x)}}(),P=e)}}function U(e,t,r,n,a,o){D();var s=t||"",i=o||"",c="",u="";(s.length>=1e3&&(s=s.substring(0,999)),i.length>=3e3&&(i=i.substring(0,2999)),s.length>=80?u=s.substring(0,80):s.length>0&&s.length<80&&(u=s),s)&&(c="string"==typeof i?i.split(": ")[0].replace('"',""):JSON.stringify(i).split(": ")[0].replace('"',""));if(b.checkIgnore("je",s)){var l=new _(p,e,c+": "+u,c+": "+s,i);l.handleLogInfo(p,l)}}function B(){for(var e=[],t=0;t<T.length;t++){var r=w[T[t]]||[];e=e.concat(r)}for(var n=0;n<T.length;n++)w[T[n]]=[];e.length>0&&b.ajax("POST",f,e,function(e){if(e&&e.data){var t=e.data;if(t&&t.data&&t.data.d){var r=t.data.c;if(r){var n=JSON.parse(r);if(o.setStorageSync("WF_CONFIG",n),i=n,0==n.s){var a=(new Date).getTime()+6e5;b.setWfCookie("webfunnyStart","p",a)}}}}},function(){})}my.webfunny=function(e){for(var t=i.ia,r=!1,n=b.getCurrentPages(),a=0;a<t.length;a++){var s=t[a].replace(/ /g,"");if(s&&-1!=n.indexOf(s)){r=!0;break}}var c=b.getWfCookie("webfunnyStart")||i.s;if(c&&"p"!=c&&!r){var l=i.wc||40,h=i.je,p=i.hl,y=my.switchTab;my.switchTab=function(e){var t=arguments[0].success,r=arguments[0].fail,n=arguments[0].complete;if(!(t||r||n))return new Promise((t,r)=>{arguments[0].success=function(...r){b.uploadCusBehavior("switchTab","success","Tab切换至："+e.url),t(...r)},arguments[0].fail=function(...t){b.uploadCusBehavior("switchTab","failed","Tab切换至："+e.url),r(...t)},y.apply(this,arguments)});arguments[0].success=function(...r){b.uploadCusBehavior("switchTab","success","Tab切换至："+e.url),t&&t(...r)},arguments[0].fail=function(...t){b.uploadCusBehavior("switchTab","failed","Tab切换至："+e.url),r&&r(...t)},y.apply(this,arguments)};var m=my.navigateBack;my.navigateBack=function(e){if(arguments[0]){var t=arguments[0].success,r=arguments[0].fail;t&&(arguments[0].success=function(...r){b.uploadCusBehavior("navigateBack","success","页面返回层数："+e.delta),t&&t(...r)}),r&&(arguments[0].fail=function(...t){b.uploadCusBehavior("navigateBack","failed","页面返回层数："+e.delta),r&&r(...t)}),m.apply(this,arguments)}else m.apply(this,arguments),b.uploadCusBehavior("navigateBack","success","页面返回层数：未传参")};var S=my.navigateTo;my.navigateTo=function(e){if(!arguments[0])return new Promise((t,r)=>{arguments[0]&&(arguments[0].success=function(...r){b.uploadCusBehavior("navigateTo","success","路由切换至："+e.url),C(e.url),t(...r)},arguments[0].fail=function(...t){b.uploadCusBehavior("navigateTo","failed","路由切换至："+e.url),r(...t)},S.apply(this,arguments))});var t=arguments[0].success,r=arguments[0].fail;t&&(arguments[0].success=function(...r){b.uploadCusBehavior("navigateTo","success","路由切换至："+e.url),C(e.url),t&&t(...r)}),r&&(arguments[0].fail=function(...t){b.uploadCusBehavior("navigateTo","failed","路由切换至："+e.url),r&&r(...t)}),S.apply(this,arguments)};var T=my.redirectTo;my.redirectTo=function(e){if(!arguments[0])return new Promise((t,r)=>{arguments[0]&&(arguments[0].success=function(...r){b.uploadCusBehavior("redirectTo","success","重定向至："+e.url),t(...r)},arguments[0].fail=function(...t){b.uploadCusBehavior("redirectTo","failed","重定向至："+e.url),r(...t)},T.apply(this,arguments))});var t=arguments[0].success,r=arguments[0].fail;t&&(arguments[0].success=function(...r){b.uploadCusBehavior("redirectTo","success","重定向至："+e.url),t&&t(...r)}),r&&(arguments[0].fail=function(...t){b.uploadCusBehavior("redirectTo","failed","重定向至："+e.url),r&&r(...t)}),T.apply(this,arguments)};var x=my.reLaunch;my.reLaunch=function(e){if(!arguments[0])return new Promise((t,r)=>{arguments[0]&&(arguments[0].success=function(...r){b.uploadCusBehavior("reLaunch","success","重启至："+e.url),t(...r)},arguments[0].fail=function(...t){b.uploadCusBehavior("reLaunch","failed","重启至："+e.url),r(...t)},x.apply(this,arguments))});var t=arguments[0].success,r=arguments[0].fail;t&&(arguments[0].success=function(...r){b.uploadCusBehavior("reLaunch","success","重启至："+e.url),t&&t(...r)}),r&&(arguments[0].fail=function(...t){b.uploadCusBehavior("reLaunch","failed","重启至："+e.url),r&&r(...t)}),x.apply(this,arguments)};var I,_=my.request;my.request=function(){function e(e,t,r,n,a,o,s,i,c){if(b.checkIgnore("hl",r)){var u=new E(e,t,r,n,a,o,s,i,c);u.handleLogInfo(e,u)}}let t=arguments[0];if(-1==t.url.indexOf(u)){t.startTime=(new Date).getTime();var r=t.method,n=t.url;e(d,r,n,"200","OK","request","","",0)}var a=arguments[0].success,o=arguments[0].fail,s=arguments[0].complete;if(!(a||o||s))return new Promise((r,n)=>{arguments[0].success=function(...n){if(-1==t.url.indexOf(u)){var a=(new Date).getTime()-t.startTime,o=t.method,s=t.url,i=n[0],c=i.statusCode;console.log("请求参数：",t);var l=b.checkReqResLen(t.data,i.data,p);e(d,o,s,c,"OK","response",l.requestText,l.responseText,a)}r(...n)},arguments[0].fail=function(...r){if(-1==t.url.indexOf(u)){var a=(new Date).getTime()-t.startTime,o=t.method,s=t.url,i=r[0],c=JSON.stringify(t.data),l=i.errMsg;e(d,o,s,555,"fail","response",c,l,a)}n(...r)},_.apply(this,arguments)});arguments[0].success=function(...r){if(console.log("request 请求成功.....",r),-1==t.url.indexOf(u)){var n=(new Date).getTime()-t.startTime,o=t.method,s=t.url,i=r[0],c=i.status,l=b.checkReqResLen(t.data,i.data,p);e(d,o,s,c,"OK","response",l.requestText,l.responseText,n)}a&&a(...r)},arguments[0].fail=function(...r){if(-1==t.url.indexOf(u)){var n=(new Date).getTime()-t.startTime,a=t.method,s=t.url,i=r[0],c=JSON.stringify(t.data),l=i.errMsg;e(d,a,s,555,"fail","response",c,l,n)}o&&o(...r)},_.apply(this,arguments)},h.s&&(I=console.error,console.error=function(e){var t=arguments[0]&&arguments[0].message||e,r=arguments[0]&&arguments[0].stack;if(r)U("on_error",t,0,0,0,r);else{if("object"==typeof t)try{t=JSON.stringify(t)}catch(e){t="错误无法解析"}U("console_error",t,0,0,0,"CustomizeError: "+t)}return I.apply(console,arguments)});var P=(new Date).getTime();setInterval(function(){D();let e=(new Date).getTime(),t=e-P;w[d].length>10?B():t>=200*l&&(B(),P=e)},1e3);var M={onLaunch:function(){!function(e){var t=b.isTodayBrowse(v),r=o.getStorageSync("monitorCustomerKey");if(r){var n="",a=r?r.match(/\d{14}/g):[];if(a&&a.length>0){var s=a[0].match(/\d{2}/g),i=s[0]+s[1]+"-"+s[2]+"-"+s[3]+" "+s[4]+":"+s[5]+":"+s[6],c=new Date(i).getTime();n=(new Date).getTime()-c>300?0==t?"o_uv":"o":"n_uv"}}else n="n_uv",b.getCustomerKey();var u=new O("reload",0,n,"");if(u.simpleUrl=e,u.completeUrl=e,"n_uv"===n||"o_uv"===n){var l=[u];b.getCusInfo("userId")?b.ajax("POST",f,l):setTimeout(function(){b.ajax("POST",f,l)},3e3)}else u.handleLogInfo(g,u)}("onLaunch")},onError:function(e,t){if(h.s){var r="";"string"==typeof e?r=e:"object"==typeof e&&(r=e.stack||"");var n=r.split("\n")[2];my&&(n=e,r=t||"无法获取堆栈"),b.getCurrentPages(),U("on_error",n,0,0,0,r)}}};for(const t in M){const r="function"==typeof e[t]&&e[t];e[t]=function(){M[t].apply(this,arguments),r&&r.apply(this,arguments)}}return e}}}]);