(function(t){var n={};function r(e){if(n[e])return n[e].exports;var o=n[e]={i:e,l:!1,exports:{}};t[e].call(o.exports,o,o.exports,r);o.l=!0;return o.exports}r.m=t;r.c=n;r.d=function(e,o,t){r.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:t})};r.r=function(e){"undefined"!=typeof undefined&&"undefined.toStringTag"&&Object.defineProperty(e,"undefined.toStringTag",{value:"Module"});Object.defineProperty(e,"__esModule",{value:!0})};r.t=function(o,e){1&e&&(o=r(o));if(8&e)return o;if(4&e&&"object"==typeof o&&o&&o.__esModule)return o;var t=Object.create(null);r.r(t);Object.defineProperty(t,"default",{enumerable:!0,value:o});if(2&e&&"string"!=typeof o)for(var n in o)r.d(t,n,function(e){return o[e]}.bind(null,n));return t};r.n=function(o){var e=o&&o.__esModule?function e(){return o["default"]}:function e(){return o};r.d(e,"a",e);return e};r.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)};r.p="";r(r.s=0)})([function(e,o,t){function r(e){return(r="function"==typeof undefined&&"symbol"==typeof "undefined.iterator"?function(e){return typeof e}:function(e){return e&&"function"==typeof undefined&&e.constructor===undefined&&e!==Object.prototype?"symbol":typeof e})(e)}t(1);t(2);t(3);t(4);t(5);t(6);t(7);t(8);t(9);var a="undefined"!=typeof window?window:this,i="1.0.0-ie8",s="WebfunnyMonitor",u={webMonitorId:"",uploadUrl:"",enablePV:!0,enableClick:!0,enableError:!0,enablePerf:!0,batchSize:10,flushInterval:3e3,maxRetries:3,timeout:5e3,debug:!1,silentMode:!1,webfunnyDomain:"",webfunnyAssetsDomain:"",webfunnyMonitorId:"",env:"pro",projectVersion:"1.0.0",hasTrace:"0",startList:[]},l={initialized:!1,modules:{},startTime:(new Date).getTime()},n={version:i,init:function e(o){try{console.log("[WebfunnyMonitor] \u5f00\u59cb\u521d\u59cb\u5316SDK...");if(l.initialized){console.log("[WebfunnyMonitor] SDK\u5df2\u7ecf\u521d\u59cb\u5316\u8fc7\u4e86");f("warn","SDK already initialized")}else{var t=function e(o){var t,n={};for(t in o)Object.prototype.hasOwnProperty.call(o,t)&&(n[t]=o[t]);o.webfunnyMonitorId&&(n.webMonitorId=o.webfunnyMonitorId);if(o.webfunnyDomain){var r=o.webfunnyDomain;"/"!==r.charAt(r.length-1)&&(r+="/");n.uploadUrl=r+"wfMonitor/upLogs"}if(o.startList&&0<o.startList.length){n.enablePV=!1;n.enablePerf=!1;n.enableClick=!1;n.enableError=!1;for(var i=0;i<o.startList.length;i++){var a=o.startList[i];if("pageView"===a){n.enablePV=!0;n.enablePerf=!0}else"behavior"===a?n.enableClick=!0:"jsError"===a?n.enableError=!0:"httpLog"===a&&(n.enableHttp=!0)}}console.log("[WebfunnyMonitor] \u914d\u7f6e\u8f6c\u6362\u8be6\u60c5:");console.log("[WebfunnyMonitor] - webfunnyMonitorId:",o.webfunnyMonitorId,"\u2192 webMonitorId:",n.webMonitorId);console.log("[WebfunnyMonitor] - webfunnyDomain:",o.webfunnyDomain,"\u2192 uploadUrl:",n.uploadUrl);console.log("[WebfunnyMonitor] - startList:",o.startList);console.log("[WebfunnyMonitor] - enablePV:",n.enablePV);console.log("[WebfunnyMonitor] - enablePerf:",n.enablePerf);console.log("[WebfunnyMonitor] - enableClick:",n.enableClick);console.log("[WebfunnyMonitor] - enableError:",n.enableError);console.log("[WebfunnyMonitor] - enableHttp:",n.enableHttp);return n}(o),n=(console.log("[WebfunnyMonitor] \u914d\u7f6e\u683c\u5f0f\u8f6c\u6362\u5b8c\u6210"),o.webfunnyMonitorId&&o.webfunnyDomain),r=o.webMonitorId&&o.uploadUrl;if(!o||!n&&!r){console.log("[WebfunnyMonitor] \u914d\u7f6e\u9a8c\u8bc1\u5931\u8d25\uff0c\u7f3a\u5c11\u5fc5\u586b\u53c2\u6570");console.log("[WebfunnyMonitor] userConfig:",o);f("error",n?"webfunnyMonitorId and webfunnyDomain are required":"webMonitorId and uploadUrl are required (old format) or webfunnyMonitorId and webfunnyDomain (new format)");return!1}console.log("[WebfunnyMonitor] \u914d\u7f6e\u9a8c\u8bc1\u901a\u8fc7");console.log("[WebfunnyMonitor] userConfig:",o);!function e(o){for(var t in o)Object.prototype.hasOwnProperty.call(o,t)&&(u[t]=o[t])}(t);console.log("[WebfunnyMonitor] \u914d\u7f6e\u5408\u5e76\u5b8c\u6210");console.log("[WebfunnyMonitor] \u5f00\u59cb\u521d\u59cb\u5316\u6a21\u5757...");if(!function e(){try{console.log("[WebfunnyMonitor] _initModules \u5f00\u59cb\u68c0\u67e5\u4f9d\u8d56\u6a21\u5757...");for(var o=["WfUtils","WfDevice","WfStorage","WfUpload","WfQueue"],t=0;t<o.length;t++){var n=o[t];if(void 0===a[n]){console.log("[WebfunnyMonitor] \u7f3a\u5c11\u5fc5\u9700\u6a21\u5757:",n);f("error","Required module not found: "+n);return}console.log("[WebfunnyMonitor] \u6a21\u5757\u68c0\u67e5\u901a\u8fc7:",n)}console.log("[WebfunnyMonitor] \u6240\u6709\u5fc5\u9700\u6a21\u5757\u68c0\u67e5\u5b8c\u6210");console.log("[WebfunnyMonitor] \u521d\u59cb\u5316\u57fa\u7840\u5de5\u5177\u6a21\u5757...");l.modules.utils=a.WfUtils;l.modules.device=a.WfDevice;l.modules.storage=a.WfStorage;if(l.modules.utils){console.log("[WebfunnyMonitor] \u8bbe\u7f6ewebMonitorId\u5230utils\u6a21\u5757");l.modules.utils.setWebMonitorId(u.webMonitorId)}console.log("[WebfunnyMonitor] \u521d\u59cb\u5316\u4e1a\u52a1\u6a21\u5757...");if(void 0!==a.WfPageView){console.log("[WebfunnyMonitor] \u521d\u59cb\u5316WfPageView\u6a21\u5757");l.modules.pageview=a.WfPageView;l.modules.pageview.init(u)}if(void 0!==a.WfAction){console.log("[WebfunnyMonitor] \u521d\u59cb\u5316WfAction\u6a21\u5757");l.modules.action=a.WfAction;l.modules.action.init(u)}if(void 0!==a.WfError){console.log("[WebfunnyMonitor] \u521d\u59cb\u5316WfError\u6a21\u5757");l.modules.error=a.WfError;l.modules.error.init(u)}if(void 0!==a.WfHttp){console.log("[WebfunnyMonitor] \u521d\u59cb\u5316WfHttp\u6a21\u5757");l.modules.http=a.WfHttp;l.modules.http.init(u,c,l.modules.utils)}console.log("[WebfunnyMonitor] \u521d\u59cb\u5316\u4e0a\u62a5\u6a21\u5757WfUpload...");l.modules.upload=a.WfUpload;l.modules.upload.init(u);console.log("[WebfunnyMonitor] \u521d\u59cb\u5316\u961f\u5217\u6a21\u5757WfQueue...");l.modules.queue=a.WfQueue;l.modules.queue.init(u,l.modules.upload);console.log("[WebfunnyMonitor] \u6240\u6709\u6a21\u5757\u521d\u59cb\u5316\u5b8c\u6210");return 1}catch(e){console.log("[WebfunnyMonitor] _initModules\u5f02\u5e38:",e.message);console.log("[WebfunnyMonitor] \u9519\u8bef\u5806\u6808:",e.stack);f("error","Module initialization failed: "+e.message)}}()){console.log("[WebfunnyMonitor] \u6a21\u5757\u521d\u59cb\u5316\u5931\u8d25");f("error","Failed to initialize modules");return!1}console.log("[WebfunnyMonitor] \u6a21\u5757\u521d\u59cb\u5316\u6210\u529f");console.log("[WebfunnyMonitor] \u542f\u52a8\u76d1\u63a7\u529f\u80fd...");!function e(){try{if(u.enablePV&&l.modules.pageview){l.modules.pageview.recordPageView(c);l.modules.pageview.bindUnloadEvent(c)}u.enableClick&&l.modules.action&&l.modules.action.startClickMonitor(c);u.enableError&&l.modules.error&&l.modules.error.startErrorMonitor(c);f("info","Monitoring started")}catch(e){f("error","Start monitoring failed: "+e.message)}}();console.log("[WebfunnyMonitor] \u8bbe\u7f6e\u5168\u5c40\u9519\u8bef\u8fb9\u754c...");!function e(){try{var i=a.onerror;a.onerror=function(e,o,t,n,r){try{e&&-1===e.indexOf("["+s+"]")&&u.enableError&&l.modules.error&&l.modules.error.recordError(r||e,c)}catch(e){}return!(!i||"function"!=typeof i)&&i.apply(this,arguments)}}catch(e){f("error","Setup error boundary failed: "+e.message)}}();l.initialized=!0;console.log("[WebfunnyMonitor] SDK\u521d\u59cb\u5316\u5b8c\u6210\uff01\u7248\u672c:",i);f("info","SDK initialized successfully, version: "+i)}return!0}catch(e){console.log("[WebfunnyMonitor] SDK\u521d\u59cb\u5316\u5f02\u5e38:",e.message);console.log("[WebfunnyMonitor] \u9519\u8bef\u5806\u6808:",e.stack);f("error","SDK initialization failed: "+e.message);return!1}},track:function e(o,t){try{return l.initialized?c({uploadType:"CUSTOMIZE_BEHAVIOR",happenTime:(new Date).getTime(),eventType:o||"custom",eventData:t||{},webMonitorId:u.webMonitorId}):(f("warn","SDK not initialized"),!1)}catch(e){f("error","Track event failed: "+e.message);return!1}},setUser:function e(o,t){try{if(l.initialized){if(l.modules.storage){l.modules.storage.setItem("userId",o||"");t&&l.modules.storage.setItem("userInfo",JSON.stringify(t))}f("info","User ID set: "+o)}else f("warn","SDK not initialized")}catch(e){f("error","Set user failed: "+e.message)}},trackPageView:function e(o){try{var t;return l.initialized&&l.modules.pageview?(t=o||function e(){try{return{href:location.href||"",pathname:location.pathname||"",search:location.search||"",hash:location.hash||"",title:document.title||""}}catch(e){return{}}}(),c(l.modules.pageview.getPageViewInfo(t,"manual"))):!1}catch(e){f("error","Track page view failed: "+e.message);return!1}},trackError:function e(o){try{return l.initialized&&l.modules.error?l.modules.error.recordError(o,c):!1}catch(e){f("error","Track error failed: "+e.message);return!1}},flush:function e(){try{l.modules.queue&&l.modules.queue.flush();l.modules.upload&&l.modules.upload.flushRetryQueue()}catch(e){f("error","Flush failed: "+e.message)}},pause:function e(){try{l.modules.queue&&l.modules.queue.pause();f("info","Monitoring paused")}catch(e){f("error","Pause failed: "+e.message)}},resume:function e(){try{l.modules.queue&&l.modules.queue.resume();f("info","Monitoring resumed")}catch(e){f("error","Resume failed: "+e.message)}},initUser:function e(o){try{if(o&&"object"===r(o))if(void 0!==a.WfUtils){if(a.WfUtils.setCusInfo(o)){f("info","User info initialized successfully");o.userTag&&a.WfUtils.setCusInfo("firstUserParam",o.userTag);console.log("[WebfunnyMonitor] \u7528\u6237\u4fe1\u606f\u5df2\u5b58\u50a8:");console.log("[WebfunnyMonitor] - userId:",o.userId||"");console.log("[WebfunnyMonitor] - userTag:",o.userTag||"");console.log("[WebfunnyMonitor] - nickname:",o.nickname||"");return!0}f("error","Failed to store user info")}else f("error","WfUtils not available");else f("error","initUser: userInfo must be an object");return!1}catch(e){f("error","initUser failed: "+e.message);return!1}},trackHttp:function e(o){try{if(l.initialized){if(l.modules.http){l.modules.http.recordHttp(o);f("info","HTTP request tracked manually");return!0}f("warning","HTTP module not available")}else f("warning","SDK not initialized, cannot track HTTP");return!1}catch(e){f("error","Track HTTP failed: "+e.message);return!1}},getStatus:function e(){try{var o={initialized:l.initialized,version:i,config:function e(o){try{if(!o||"object"!==r(o))return o;var t,n={};for(t in o)Object.prototype.hasOwnProperty.call(o,t)&&(n[t]=o[t]);return n}catch(e){return{}}}(u),uptime:(new Date).getTime()-l.startTime};l.modules.queue&&(o.queue=l.modules.queue.getStatus());l.modules.upload&&(o.upload=l.modules.upload.getRetryQueueStatus());l.modules.device&&(o.device=l.modules.device.getSimpleInfo());return o}catch(e){f("error","Get status failed: "+e.message);return{initialized:!1,version:i}}},destroy:function e(){try{this.flush();l.modules.action&&l.modules.action.stopClickMonitor&&l.modules.action.stopClickMonitor();l.modules.error&&l.modules.error.stopErrorMonitor&&l.modules.error.stopErrorMonitor();l.modules.queue&&l.modules.queue.clear();l.initialized=!1;l.modules={};f("info","SDK destroyed")}catch(e){f("error","Destroy failed: "+e.message)}}};function c(e){try{return e&&l.modules.queue?l.modules.queue.add(e):!1}catch(e){f("error","Add to queue failed: "+e.message);return!1}}function f(e,o){if(!u.silentMode){o="["+s+"] "+o;if("undefined"!=typeof console)try{!u.debug&&"error"!==e||(console[e]?console[e](o):console.log&&console.log("["+e.toUpperCase()+"] "+o))}catch(e){}}}function d(){try{void 0!==a.webfunnyMonitorConfig&&setTimeout(function(){n.init(a.webfunnyMonitorConfig)},0);void 0!==a.webfunnyIE8Config&&setTimeout(function(){n.init(a.webfunnyIE8Config)},0)}catch(e){}}if(void 0!==a){a.WebfunnyMonitor=n;a[s]=n;a.WebfunnyIE8=n}e.exports?e.exports=n:void 0!==a&&"function"==typeof a.define&&a.define.amd&&a.define(function(){return n});void 0!==a&&("loading"===document.readyState?document.addEventListener?document.addEventListener("DOMContentLoaded",d,!1):document.attachEvent&&document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&d()}):d())},function(e,o,t){function u(e){return(u="function"==typeof undefined&&"symbol"==typeof "undefined.iterator"?function(e){return typeof e}:function(e){return e&&"function"==typeof undefined&&e.constructor===undefined&&e!==Object.prototype?"symbol":typeof e})(e)}n={webMonitorId:""},c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a="monitorCustomerKeys";var n,c,a,WfUtils={getUuid:function e(){var o=this.formatDate((new Date).getTime(),"yMdhms"),t=this;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var o=16*t.wfRandom()|0;return("x"===e?o:3&o|8).toString(16)})+"-"+o},formatDate:function e(o,t){try{var n=new Date(o),r=n.getFullYear(),i=n.getMonth()+1,a=n.getDate(),s=n.getHours(),u=n.getMinutes(),l=n.getSeconds(),i=9<i?i:"0"+i,a=9<a?a:"0"+a,s=9<s?s:"0"+s,u=9<u?u:"0"+u,l=9<l?l:"0"+l;return t.replace("y",r).replace("M",i).replace("d",a).replace("h",s).replace("m",u).replace("s",l)}catch(e){return""}},wfRandom:function e(){return Math[["m","o","d","n","a","r"].reverse().join("")]()},perfSubtract:function e(o,t){return 0===o||0===t?0:o-t},b64Code:function e(o){if(!o)return"";try{var t=encodeURIComponent(o);if("undefined"!=typeof btoa)try{return btoa(t)}catch(e){}return this._base64Encode(t)}catch(e){return o}},_base64Encode:function e(o){for(var t,n,r,i,a,s,u="",l=0;l<o.length;){r=(t=o.charCodeAt(l++))>>2;i=(3&t)<<4|(t=o.charCodeAt(l++))>>4;a=(15&t)<<2|(n=o.charCodeAt(l++))>>6;s=63&n;isNaN(t)?a=s=64:isNaN(n)&&(s=64);u=u+c.charAt(r)+c.charAt(i)+c.charAt(a)+c.charAt(s)}return u},setWebMonitorId:function e(o){n.webMonitorId=o||""},getWebMonitorId:function e(){return n.webMonitorId},getCustomerKey:function e(o){if(!o)return{customerKey:"",newStatus:"old"};var t="",n="old";try{var r=this._getStorageItem(a),i={};if(r)try{i=JSON.parse(r)}catch(e){i={}}if(i[o]){t=i[o];n="old"}else{t=this._generateCustomerKey();i[o]=t;n="new";this._setStorageItem(a,JSON.stringify(i))}}catch(e){t=this._generateCustomerKey();n="new"}return{customerKey:t,newStatus:n}},_generateCustomerKey:function e(){return this.getUuid()},_setStorageItem:function e(o,t){try{"undefined"!=typeof localStorage&&localStorage.setItem(o,t)}catch(e){}},_getStorageItem:function e(o){try{if("undefined"!=typeof localStorage)return localStorage.getItem(o)}catch(e){}return null},getCusInfo:function e(o){try{if(o&&"undefined"!=typeof localStorage){var t=localStorage.getItem("wmUserInfo");if(t)return JSON.parse(t)[o]||""}return""}catch(e){return""}},setCusInfo:function e(o,t){try{if(!o)return!1;if("undefined"==typeof localStorage)return!1;var n={},r=localStorage.getItem("wmUserInfo");if(r)try{n=JSON.parse(r)}catch(e){n={}}if("object"===u(o))for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i]);else n[o]=t;localStorage.setItem("wmUserInfo",JSON.stringify(n));return!0}catch(e){this.log("error","setCusInfo error: "+e.message);return!1}},getAppInfo:function e(o){try{if(o){if("env"===o)return n.env||"pro";if("projectVersion"===o)return n.projectVersion||"1.0.0";if("undefined"!=typeof localStorage){var t=localStorage.getItem("wmAppInfo");if(t)return JSON.parse(t)[o]||""}}return""}catch(e){return""}},getKeyByWebMonitorId:function e(o){try{var t=this.getCustomerKey(o);return{customerKey:t.customerKey,newStatus:t.newStatus}}catch(e){return{customerKey:this._generateCustomerKey(),newStatus:"new"}}},getBaseInfo:function e(){try{var o=this.getWebMonitorId(),t=this.getAppInfo("projectVersion"),n=this.getAppInfo("env"),r=this.getCusInfo("userId"),i=this.getCusInfo("userTag")||this.getCusInfo("firstUserParam"),a=window.location.href,s=window.location.href.split("?")[0],u=this.getKeyByWebMonitorId(o);return{webMonitorId:o,userId:r,firstUserParam:i,projectVersion:t,env:n,completeUrl:a,simpleUrl:s,customerKey:u.customerKey,newStatus:u.newStatus}}catch(e){this.log("error","getBaseInfo error: "+e.message);return{webMonitorId:this.getWebMonitorId(),userId:"",firstUserParam:"",projectVersion:"1.0.0",env:"pro",completeUrl:"",simpleUrl:"",customerKey:this._generateCustomerKey(),newStatus:"new"}}},extend:function e(o,t){o=o||{};if(t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(o[n]=t[n]);return o},toQueryString:function e(o){if(!o)return"";var t,n=[];for(t in o)if(Object.prototype.hasOwnProperty.call(o,t)){var r=o[t];null!=r&&n.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}return n.join("&")},now:function e(){return Date.now?Date.now():(new Date).getTime()},isIE8:function e(){return"object"===("undefined"==typeof navigator?"undefined":u(navigator))&&"Microsoft Internet Explorer"===navigator.appName&&-1!==navigator.appVersion.indexOf("MSIE 8.")},isIE8Below:function e(){return"object"===("undefined"==typeof navigator?"undefined":u(navigator))&&"Microsoft Internet Explorer"===navigator.appName&&parseInt(navigator.appVersion.split(";")[1].replace(/[ ]/g,"").replace("MSIE",""))<=8},b64CodeForLog:function e(o){if(!o||"object"!==u(o))return o;try{var t,n={},r=["happenTime","webMonitorId","completeUrl","simpleUrl","uploadType","logContent"];for(t in o)if(Object.prototype.hasOwnProperty.call(o,t)){for(var i=o[t],a=!1,s=0;s<r.length;s++)if(t===r[s]){a=!0;break}n[t]=a||"string"!=typeof i||""===i?i:this.b64Code(i)}return n}catch(e){this.log("error","b64CodeForLog error: "+e.message);return o}},log:function e(o,t){if("undefined"!=typeof console&&console[o])try{console[o]("[WebfunnyIE8] "+t)}catch(e){}}};"undefined"!=typeof window&&(window.WfUtils=WfUtils);e.exports?e.exports=WfUtils:"undefined"!=typeof window&&"function"==typeof window.define&&window.define.amd&&window.define(function(){return WfUtils})},function(e,o,t){var WfDevice={getInfo:n,getSimpleInfo:function e(){var o=n();return{deviceName:o.deviceName,deviceSize:o.deviceSize,os:o.os+(o.osVersion?" "+o.osVersion:""),browserName:o.browserName,browserVersion:o.browserVersion}},isIE8:function e(){return n().isIE8},getIE8Features:function e(){var o={hasLocalStorage:!1,hasJSON:!1,hasConsole:!1,hasPerformance:!1,documentMode:null};try{o.hasLocalStorage="undefined"!=typeof localStorage;o.hasJSON="undefined"!=typeof JSON;o.hasConsole="undefined"!=typeof console;o.hasPerformance="undefined"!=typeof performance;document.documentMode&&(o.documentMode=document.documentMode)}catch(e){}return o},getNetworkType:function e(){try{return navigator.connection&&navigator.connection.effectiveType?navigator.connection.effectiveType:"unknown"}catch(e){return"unknown"}}};function n(){var e={deviceName:"PC",deviceSize:"1024x768",os:"web",osVersion:"",browserName:"\u5176\u4ed6",browserVersion:"",isWeixin:!1,isIE8:!1};try{var o=navigator.userAgent||"",t=screen.width||1024;e.deviceSize=t+"x"+(screen.height||768);e.isWeixin=-1<o.indexOf("MicroMessenger");if(-1<o.indexOf("Mobile")){e.deviceName="Mobile Device";e.os="mobile";e.browserName="mobile"}else{var n=function e(o){var t={browserName:"\u5176\u4ed6",browserVersion:"",isIE8:!1};try{var n=o.toLowerCase();if(-1<n.indexOf("msie")){t.browserName="ie";var r=n.match(/msie\s+([\d.]+)/);if(r){t.browserVersion=r[1];t.isIE8=0===r[1].indexOf("8.")}}else if(-1<n.indexOf("edg")){t.browserName="edge";var i=n.match(/edg\/([\d.]+)/);i&&(t.browserVersion=i[1])}else if(-1<n.indexOf("firefox")){t.browserName="firefox";var a=n.match(/firefox\/([\d.]+)/);a&&(t.browserVersion=a[1])}else if(-1<n.indexOf("safari")&&-1===n.indexOf("chrome")){t.browserName="safari";var s=n.match(/safari\/([\d.]+)/);s&&(t.browserVersion=s[1])}else if(-1<n.indexOf("chrome")){t.browserName="chrome";var u=n.match(/chrome\/([\d.]+)/);u&&(t.browserVersion=u[1]);if(-1<n.indexOf("360se")){t.browserName="360";var l=n.match(/360se\/([\d.]+)/);l&&(t.browserVersion=l[1])}}else if(-1<n.indexOf("micromessenger")){t.browserName="weixin";var c=o.match(/MicroMessenger\/([\d.]+)/i);c&&(t.browserVersion=c[1])}}catch(e){}return t}(o);e.browserName=n.browserName;e.browserVersion=n.browserVersion;e.isIE8=n.isIE8;var r=function e(o){var t={os:"web",osVersion:"",deviceName:"PC"};try{var n=navigator.platform?navigator.platform.toLowerCase():"",r=o.toLowerCase();if(-1!==n.indexOf("win")||-1!==r.indexOf("windows")){t.os="windows";t.deviceName="Windows PC";if(-1!==r.indexOf("windows nt 10.0"))t.osVersion="10";else if(-1!==r.indexOf("windows nt 6.3"))t.osVersion="8.1";else if(-1!==r.indexOf("windows nt 6.2"))t.osVersion="8";else if(-1!==r.indexOf("windows nt 6.1"))t.osVersion="7";else if(-1!==r.indexOf("windows nt 6.0"))t.osVersion="Vista";else if(-1!==r.indexOf("windows nt 5.1"))t.osVersion="XP";else if(-1!==r.indexOf("windows nt 5.0"))t.osVersion="2000";else{var i=r.match(/windows nt ([\d.]+)/);t.osVersion=i?i[1]:"Unknown"}}else if(-1!==n.indexOf("mac")){t.os="macos";t.deviceName="Mac";var a=r.match(/mac os x ([\d_]+)/);if(a)t.osVersion=a[1].replace(/_/g,".");else{var s=r.match(/mac os x ([\d.]+)/);s&&(t.osVersion=s[1])}}else if(-1!==n.indexOf("linux")){t.os="linux";t.deviceName="Linux PC";-1!==r.indexOf("ubuntu")?t.osVersion="Ubuntu":-1!==r.indexOf("fedora")?t.osVersion="Fedora":-1!==r.indexOf("centos")?t.osVersion="CentOS":-1!==r.indexOf("debian")?t.osVersion="Debian":t.osVersion="Unknown"}else if(-1!==r.indexOf("cros")){t.os="chromeos";t.deviceName="Chromebook";var u=r.match(/cros [\w]+ ([\d.]+)/);u&&(t.osVersion=u[1])}}catch(e){}return t}(o);e.os=r.os;e.osVersion=r.osVersion;e.deviceName=r.deviceName}}catch(e){if("undefined"!=typeof console&&console.error)try{console.error("[WfDevice] getDeviceInfo error: "+e.message)}catch(e){}}return e}"undefined"!=typeof window&&(window.WfDevice=WfDevice);e.exports?e.exports=WfDevice:"undefined"!=typeof window&&"function"==typeof window.define&&window.define.amd&&window.define(function(){return WfDevice})},function(e,o,t){r="webfunny_monitor",n="monitorCustomerKeys",i="lastBrowseDate",a="visitPageCount";var r,n,i,a,WfStorage={setItem:function e(o,t){return!(!o||null==t)&&(t=String(t),!(!l()||!s(o,t))||u(o,t,3650))},getItem:function e(o){if(!o)return null;if(l()){var t=function e(o){try{var t=document.createElement("div");t.style.behavior="url(#default#userData)";t.style.display="none";document.body.appendChild(t);t.load(r);var n=t.getAttribute(o);document.body.removeChild(t);return n||null}catch(e){return null}}(o);if(null!==t)return t}return function e(o){try{for(var t="wf_"+o+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var i=n[r];" "===i.charAt(0);)i=i.substring(1);if(0===i.indexOf(t))return decodeURIComponent(i.substring(t.length))}return null}catch(e){return null}}(o)},removeItem:function e(o){if(!o)return!1;var t=!1;l()&&(t=s(o,"")||t);return t=u(o,"",-1)||t},recordVisit:function e(o){if(o)try{var t=this._getToday();if(this.getItem(i)!==t){this.setItem(i,t);this.setItem(a+"_"+o,"1")}else{var n=a+"_"+o,r=parseInt(this.getItem(n)||"0");this.setItem(n,String(r+1))}}catch(e){}},_getToday:function e(){var o=new Date,t=o.getFullYear(),n=o.getMonth()+1,o=o.getDate();return t+"-"+(n<10?"0"+n:n)+"-"+(o<10?"0"+o:o)},getVisitStats:function e(o){if(!o)return{isNewDay:!1,visitCount:0};try{var t=this._getToday(),n=this.getItem(i),r=a+"_"+o;return{isNewDay:n!==t,visitCount:parseInt(this.getItem(r)||"0")}}catch(e){return{isNewDay:!1,visitCount:0}}},clear:function e(){try{this.removeItem(n);this.removeItem(i);for(var o=0;o<10;o++)this.removeItem(a+"_key"+o);return!0}catch(e){return!1}},checkSupport:function e(){return{userData:l(),cookie:"undefined"!=typeof document&&"string"==typeof document.cookie}}};function s(e,o){try{var t=document.createElement("div");t.style.behavior="url(#default#userData)";t.style.display="none";document.body.appendChild(t);t.setAttribute(e,o);t.save(r);document.body.removeChild(t);return!0}catch(e){return!1}}function u(e,o,t){try{var n="";if(t){var r=new Date;r.setTime(r.getTime()+24*t*60*60*1e3);n="; expires="+r.toUTCString()}document.cookie="wf_"+e+"="+encodeURIComponent(o)+n+"; path=/";return!0}catch(e){return!1}}function l(){try{if("undefined"==typeof document)return!1;if(!document.createElement)return!1;var e=document.createElement("div");e.style.behavior="url(#default#userData)";return"function"==typeof e.save}catch(e){return!1}}"undefined"!=typeof window&&(window.WfStorage=WfStorage);e.exports?e.exports=WfStorage:"undefined"!=typeof window&&"function"==typeof window.define&&window.define.amd&&window.define(function(){return WfStorage})},function(e,o,t){c={CUSTOMER_PV:"CUSTOMER_PV",CUS_LEAVE:"CUS_LEAVE",PAGE_LOAD:"PAGE_LOAD"},i=(new Date).getTime(),f={webMonitorId:"",uploadUrl:""};var c,i,f,WfPageView={init:function e(o){if(o){f.webMonitorId=o.webMonitorId||"";f.uploadUrl=o.uploadUrl||""}},getPageViewInfo:r,getLoadPageInfo:a,getLeavePageViewInfo:n,recordPageView:function e(o){try{if(f.webMonitorId){void 0!==window.WfStorage&&window.WfStorage.recordVisit(f.webMonitorId);var t=w(),n=r(t,"navigate");n&&o&&o(n);setTimeout(function(){var e=a(t,"navigate");e&&o&&o(e)},1e3)}else m("webMonitorId not configured")}catch(e){m("recordPageView error: "+e.message)}},bindUnloadEvent:function e(t){try{var o=function e(){var o=n(w(),{leaveType:1});o&&t&&t(o)};if(window.attachEvent){window.attachEvent("onbeforeunload",o);window.attachEvent("onunload",o)}else if(window.addEventListener){window.addEventListener("beforeunload",o,!1);window.addEventListener("unload",o,!1)}else{window.onbeforeunload=o;window.onunload=o}}catch(e){m("bindUnloadEvent error: "+e.message)}},getStayTime:function e(){return(new Date).getTime()-i},getUploadTypes:function e(){return c}};function r(e,o){try{var t=void 0!==window.WfDevice?window.WfDevice.getSimpleInfo():d(),n=void 0!==window.WfUtils?window.WfUtils.getCustomerKey(f.webMonitorId):function e(){return{customerKey:"guest_"+(new Date).getTime(),newStatus:"new"}}(),r=w(),i=window.WfUtils.getCusInfo("userId")||"",a=window.WfUtils.getCusInfo("firstUserParam")||"",s=window.WfUtils.getAppInfo("projectVersion")||"1.0.0",u=window.WfUtils.getAppInfo("env")||"pro",l=g(e||{},{webMonitorId:f.webMonitorId,userId:i,firstUserParam:a,projectVersion:s,env:u,completeUrl:r.completeUrl,simpleUrl:r.simpleUrl,customerKey:n.customerKey,uploadType:c.CUSTOMER_PV,happenTime:(new Date).getTime(),pageKey:function e(){try{var o,t;return void 0!==window.WfUtils&&window.WfUtils.getUuid?window.WfUtils.getUuid():(o=(new Date).getTime(),t=Math.floor(1e4*Math.random()),"page_"+o+"_"+t)}catch(e){return"page_"+(new Date).getTime()}}(),deviceName:t.deviceName,deviceSize:t.deviceSize,os:t.os,browserName:t.browserName,browserVersion:t.browserVersion,monitorIp:"",country:"",province:"",city:"",loadType:o||"navigate",newStatus:n.newStatus,referrer:function e(){try{var o,t=document.referrer||"";return t?(o=t.split("?")[0],void 0!==window.WfUtils&&window.WfUtils.b64Code?window.WfUtils.b64Code(o):encodeURIComponent(o)):""}catch(e){return""}}()});return window.WfUtils.b64CodeForLog(l)}catch(e){m("getPageViewInfo error: "+e.message);return null}}function a(e,o){try{var t=void 0!==window.WfDevice?window.WfDevice.getSimpleInfo():d(),n=function e(){var o={firstByte:0,domReady:0,pageCompleteLoaded:0};try{if(window.performance&&window.performance.timing){var t=window.performance.timing,n=t.navigationStart||t.fetchStart;if(n){o.firstByte=t.responseStart?t.responseStart-n:0;o.domReady=t.domContentLoadedEventEnd?t.domContentLoadedEventEnd-n:0;o.pageCompleteLoaded=t.loadEventStart?t.loadEventStart-n:0}}else{var r=(new Date).getTime();o.pageCompleteLoaded=r-i}}catch(e){}return o}();return g(e||{},{webMonitorId:f.webMonitorId,uploadType:c.PAGE_LOAD,happenTime:(new Date).getTime(),loadType:o||"navigate",firstByte:n.firstByte,domReady:n.domReady,pageCompleteLoaded:n.pageCompleteLoaded,dns:0,tcp:0,ssl:0,response:0,conTrans:0,domAnalysis:0,resourceLoaded:0,effectiveType:"unknown",os:t.os})}catch(e){m("getLoadPageInfo error: "+e.message);return null}}function n(e,o){try{var t=(o||{}).leaveType||1;return g(e||{},{webMonitorId:f.webMonitorId,uploadType:c.CUS_LEAVE,happenTime:(new Date).getTime(),leaveType:t,stayTime:(new Date).getTime()-i})}catch(e){m("getLeavePageViewInfo error: "+e.message);return null}}function d(){return{deviceName:"PC",deviceSize:(screen.width||1024)+"x"+(screen.height||768),os:"windows",browserName:"ie",browserVersion:"8.0"}}function g(e,o){var t,n,r={};for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(r[n]=o[n]);return r}function m(e){if("undefined"!=typeof console&&console.error)try{console.error("[WfPageView] "+e)}catch(e){}}function w(){try{var e=window.location.href||"",o=e.split("?")[0];return{completeUrl:e,simpleUrl:o}}catch(e){return{completeUrl:"",simpleUrl:""}}}"undefined"!=typeof window&&(window.WfPageView=WfPageView);e.exports?e.exports=WfPageView:"undefined"!=typeof window&&"function"==typeof window.define&&window.define.amd&&window.define(function(){return WfPageView})},function(e,o,t){r=!(n={ELE_BEHAVIOR:"ELE_BEHAVIOR"});var n,r,WfAction={init:function e(o){if(o){o.webMonitorId;0}},getClickInfo:s,startClickMonitor:function e(o){try{if(r)l("Click monitor already initialized");else if(o&&"function"==typeof o){!function e(o,t,n){try{o.addEventListener?o.addEventListener(t,n,!1):o.attachEvent?o.attachEvent("on"+t,function(e){(e=e||window.event).target=e.target||e.srcElement;n.call(o,e)}):o["on"+t]=n}catch(e){l("_addEventListener error: "+e.message)}}(document,"click",function(e){!function e(o,t){try{var n=o||window.event,r=n.target||n.srcElement;if(r){var i=u(r),a=s(window.WfUtils.getBaseInfo(),i);a&&t&&t(a)}}catch(o){l("_handleClickEvent error: "+o.message)}}(e,o)});r=!0}else l("Upload callback is required")}catch(e){l("startClickMonitor error: "+e.message)}},recordClick:function e(o,t){try{if(o&&t){var n=u(o),r=s(window.WfUtils.getBaseInfo(),n);r&&t(r)}}catch(e){l("recordClick error: "+e.message)}},stopClickMonitor:function e(){try{r=!1}catch(e){l("stopClickMonitor error: "+e.message)}},isInitialized:function e(){return r},getUploadTypes:function e(){return n}};function s(e,o){try{var t=function e(o,t){var n,r,i={};for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(i[n]=o[n]);for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r]);return i}(e||{},{uploadType:n.ELE_BEHAVIOR,happenTime:(new Date).getTime(),behaviorType:o.behaviorType||"click",className:o.className||"",placeholder:o.placeholder||"",inputValue:o.inputValue||"",tagName:o.tagName||"",innerText:o.innerText||""});return window.WfUtils.b64CodeForLog(t)}catch(e){l("getClickInfo error: "+e.message);return null}}function u(e){var o={behaviorType:"click",className:"",placeholder:"",inputValue:"",tagName:"",innerText:""};try{if(!e)return o;o.tagName=e.tagName?e.tagName.toLowerCase():"";if("svg"===o.tagName||"use"===o.tagName)return o;e.className&&(o.className="string"==typeof e.className?e.className:e.className.baseVal||"");e.placeholder&&(o.placeholder=e.placeholder);void 0!==e.value&&(o.inputValue=e.value);var t="";void 0!==e.innerText?t=e.innerText:void 0!==e.textContent&&(t=e.textContent);if(t){100<(t=t.replace(/\s+/g," ").replace(/^\s+|\s+$/g,"")).length&&(t=t.substring(0,50)+" ... "+t.substring(t.length-49));o.innerText=t}}catch(e){l("_extractElementInfo error: "+e.message)}return o}function l(e){if("undefined"!=typeof console&&console.error)try{console.error("[WfAction] "+e)}catch(e){}}"undefined"!=typeof window&&(window.WfAction=WfAction);e.exports?e.exports=WfAction:"undefined"!=typeof window&&"function"==typeof window.define&&window.define.amd&&window.define(function(){return WfAction})},function(e,o,t){function l(e){return(l="function"==typeof undefined&&"symbol"==typeof "undefined.iterator"?function(e){return typeof e}:function(e){return e&&"function"==typeof undefined&&e.constructor===undefined&&e!==Object.prototype?"symbol":typeof e})(e)}s={JS_ERROR:"JS_ERROR"},f="on_error",n=!(u="console_error"),a=null;var s,f,u,n,a,WfError={init:function e(o){if(o){o.webMonitorId;0}},getJavaScriptErrorInfo:d,startErrorMonitor:function e(i){try{if(n)g("Error monitor already initialized");else if(i&&"function"==typeof i){a=window.onerror;window.onerror=function(e,o,t,n,r){try{!function e(o,t,n,r,i,a){try{var s=o||"Unknown error",u="",u=i&&i.stack?i.stack:i&&i.message?i.message:s+" at "+(t||"unknown")+":"+(n||0),l={infoType:f,errorMsg:s,errorObj:u},c=d(window.WfUtils.getBaseInfo(),l);c&&a&&a(c)}catch(e){g("_handleWindowError error: "+e.message)}}(e,o,t,0,r,i);return a&&"function"==typeof a?a.apply(this,arguments):!1}catch(e){g("window.onerror handler error: "+e.message);return!1}};n=!0}else g("Upload callback is required")}catch(e){g("startErrorMonitor error: "+e.message)}},recordError:function e(o,t){try{if(t){var n="",r="";if("string"==typeof o)r="Manual error: "+(n=o);else if(o&&o.message){n=o.message;r=o.stack||o.message}else{n=String(o);r=String(o)}var i={infoType:u,errorMsg:n,errorObj:r},a=d(window.WfUtils.getBaseInfo(),i);a&&t(a)}}catch(e){g("recordError error: "+e.message)}},stopErrorMonitor:function e(){try{if(n){window.onerror=a;a=null;n=!1}}catch(e){g("stopErrorMonitor error: "+e.message)}},isInitialized:function e(){return n},getUploadTypes:function e(){return s}};function d(e,o){try{var t=o||{},n=t.infoType||u,r=function e(o,t){var n={fullMessage:"",simpleMessage:"",stack:"",errorType:""};try{var r=o||"",i=t||"";if(0===r.length&&0===i.length)return n;1e3<=r.length&&(r=r.substring(0,999));if("string"==typeof i&&3e3<=i.length)i=i.substring(0,2999);else if("object"===l(i))try{3e3<=(i=JSON.stringify(i)).length&&(i=i.substring(0,2999))}catch(e){i=String(i)}var a="",s=(80<=r.length?a=r.substring(0,80):0<r.length&&r.length<80&&(a=r),"");if(r)if("string"==typeof i)s=i.split(": ")[0].replace(/"/g,"");else{var u=String(i);s=u.split(": ")[0].replace(/"/g,"")}n.fullMessage=s+": "+r;n.simpleMessage=s+": "+a;n.stack=String(i);n.errorType=s}catch(e){g("_processErrorMessage error: "+e.message)}return n}(t.errorMsg||"",t.errorObj||""),i=function e(){try{return"undefined"!=typeof window&&void 0!==window.WfDevice?window.WfDevice.getSimpleInfo():{deviceName:"PC",os:"windows",browserName:"ie",browserVersion:"8.0"}}catch(e){return{deviceName:"PC",os:"windows",browserName:"ie",browserVersion:"8.0"}}}(),a=function e(o,t){var n,r,i={};for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(i[n]=o[n]);for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r]);return i}(e||{},{uploadType:s.JS_ERROR,happenTime:(new Date).getTime(),infoType:n,pageKey:function e(){try{var o,t;return"undefined"!=typeof window&&void 0!==window.WfUtils&&window.WfUtils.getUuid?window.WfUtils.getUuid():(o=(new Date).getTime(),t=Math.floor(1e4*Math.random()),"error_"+o+"_"+t)}catch(e){return"error_"+(new Date).getTime()}}(),deviceName:i.deviceName,os:i.os,browserName:i.browserName,browserVersion:i.browserVersion,monitorIp:"",country:"",province:"",city:"",simpleErrorMessage:r.simpleMessage,errorMessage:r.fullMessage,errorStack:r.stack,browserInfo:navigator.userAgent||""});return window.WfUtils.b64CodeForLog(a)}catch(e){g("getJavaScriptErrorInfo error: "+e.message);return null}}function g(e){if("undefined"!=typeof console&&console.error)try{console.error("[WfError] "+e)}catch(e){}}"undefined"!=typeof window&&(window.WfError=WfError);e.exports?e.exports=WfError:"undefined"!=typeof window&&"function"==typeof window.define&&window.define.amd&&window.define(function(){return WfError})},function(e,o,t){var N={},L=null,u=null,r=null,k={OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},q=["/wfMonitor/upLog","/wfMonitor/upDLog","/wfMonitor/upLogs","/wfEvent/upEvent","/wfEvent/upEvents","/wfEvent/initCf"];function A(o,e){try{if(!o)return null;var t,n=document.createElement("a");if(e&&!o.match(/^https?:\/\//))if(o.startsWith("//"))o=window.location.protocol+o;else if(o.startsWith("/")){(t=document.createElement("a")).href=e;o=t.protocol+"//"+t.host+o}else{(t=document.createElement("a")).href=e;o=t.href.replace(/\/[^\/]*$/,"/")+o}n.href=o;return{href:n.href,protocol:n.protocol,host:n.host,hostname:n.hostname,port:n.port,pathname:n.pathname,search:n.search,hash:n.hash}}catch(e){console.log("[WfHttp] Parse URL failed:",e.message);return{href:o,protocol:"",host:"",hostname:"",port:"",pathname:"",search:"",hash:""}}}function j(e){return e?1e4<e.length?e.substring(0,1e4)+"...":e:""}function z(e){try{var o=e.simpleUrl||e.url||"";if(!o&&e.url){var t=A(e.url);t&&(o=t.protocol+"//"+t.host+t.pathname)}if(!L||!L.checkIgnore||!L.checkIgnore("hl",o)){var n=!1;if(o)for(var r=0;r<q.length;r++)if(-1!==o.indexOf(q[r])){n=!0;break}if(n)return}var i,a=L?L.getBaseInfo():{},s={uploadType:"HTTP_LOG",happenTime:e.currentTime||(new Date).getTime(),method:e.method||"GET",simpleUrl:e.simpleUrl||"",url:e.url||"",status:e.status||0,statusText:e.statusText||"",statusResult:e.statusResult||"request",currentTime:e.currentTime||(new Date).getTime(),loadTime:e.loadTime||0,headerText:e.headerText||"",requestText:e.requestText||"",responseText:e.responseText||"",segment:e.segment||"",traceId:e.traceId||""};L&&L.b64CodeForLog&&(s=L.b64CodeForLog(s));for(i in a)Object.prototype.hasOwnProperty.call(a,i)&&(s[i]=a[i]);console.log("[WfHttp] \u5b58\u50a8HTTP\u65e5\u5fd7:",s);u?u(s)?console.log("[WfHttp] HTTP\u65e5\u5fd7\u5df2\u6dfb\u52a0\u5230\u961f\u5217"):console.log("[WfHttp] HTTP\u65e5\u5fd7\u6dfb\u52a0\u961f\u5217\u5931\u8d25"):console.log("[WfHttp] \u961f\u5217\u51fd\u6570\u4e0d\u53ef\u7528\uff0c\u65e0\u6cd5\u6dfb\u52a0HTTP\u65e5\u5fd7")}catch(e){console.log("[WfHttp] Store HTTP log failed:",e.message)}}function a(e,o){try{"xhrReadyStateChange"===o&&!function _(e){try{L?L.getUuid():(new Date).getTime(),L?L.getUuid():(new Date).getTime();var o=N.webMonitorId||"unknown",t=N.hasTrace||"0",n=L?L.getUuid():"trace_"+(new Date).getTime(),r=L?L.getUuid():"segment_"+(new Date).getTime(),i={traceId:n,service:o,spans:[],serviceInstance:L?L.getAppInfo("projectVersion"):"1.0.0",serviceEnvironment:L?L.getAppInfo("env"):"prod",traceSegmentId:r},a=window.location.pathname,s=e.detail.readyState,u=e.detail.getRequestConfig,l={},c=(u&&u[1]&&(l=0===u[1].indexOf("http://")||0===u[1].indexOf("https://")?A(u[1]):0===u[1].indexOf("//")?A(window.location.protocol+u[1]):A(u[1],window.location.href)),!1);if(l&&l.href)for(var f=0;f<q.length;f++)if(-1!==l.href.indexOf(q[f])){c=!0;break}if(!0!==c){if(s===k.OPENED){window._wfHttpCollector||(window._wfHttpCollector=[]);window._wfHttpCollector.push({event:e.detail,startTime:(new Date).getTime(),traceId:n,traceSegmentId:r});if("1"===t&&L){var d=String(L.b64Code?L.b64Code(n):n),g=String(L.b64Code?L.b64Code(r):r),m=String(L.b64Code?L.b64Code(o):o),w=String(L.b64Code?L.b64Code(i.serviceInstance):i.serviceInstance),p=String(L.b64Code?L.b64Code(a):a),y=String(L.b64Code?L.b64Code(window.location.host):window.location.host),h=i.spans.length,v="1-"+d+"-"+g+"-"+h+"-"+m+"-"+w+"-"+p+"-"+y;try{e.detail.setRequestHeader("sw8",v)}catch(e){console.log("[WfHttp] Set trace header failed:",e.message)}}}if(s===k.DONE)for(var b=(new Date).getTime()+1,T=window._wfHttpCollector||[],I=0;I<T.length;I++)if(T[I].event.readyState===k.DONE){var W=l,S=e.detail.getRequestBody||"",M="";try{var x=e.detail;if(x){var U=x.responseType||"";""===U||"text"===U?M=x.responseText||"":"json"===U&&(M=JSON.stringify(x.response||{}))}}catch(e){M=""}S=j(S);M=j(M);var E=u?u[0]:"GET",C=e.detail.status||0,O=e.detail.statusText||"",D=T[I].startTime,R=b-D,P=T[I].traceId,V=(T[I].traceSegmentId,"0"===t&&(i=""),W.href||l.protocol+"//"+l.host+l.pathname),H=W.href||V;z({uploadType:"HTTP_LOG",method:E,headerText:"",simpleUrl:H,url:V,status:C,statusText:O,statusResult:"request",requestText:"",responseText:"",currentTime:D,loadTime:0});z({uploadType:"HTTP_LOG",method:E,headerText:"",simpleUrl:H,url:V,status:C,statusText:O,statusResult:"response",requestText:S,responseText:M,currentTime:b,loadTime:R,segment:i,traceId:P});T.splice(I,1);break}}}catch(e){console.log("[WfHttp] XHR state change error:",e.message)}}({detail:e})}catch(e){console.log("[WfHttp] Trigger event failed:",e.message)}}var n={init:function e(o,t,n){try{console.log("[WfHttp] Initializing HTTP monitoring...");u=t;L=n;if((N=o||{}).enableHttp){window._wfHttpCollector=[];!function e(){try{var o=function e(){var o=new r,t=o.onreadystatechange;o.onreadystatechange=function(){try{a(this,"xhrReadyStateChange")}catch(e){console.log("[WfHttp] ReadyStateChange error:",e.message)}t&&t.apply(this,arguments)};o.open=function(e,o,t,n,r){this.getRequestConfig=arguments;return i.apply(this,arguments)};o.send=function(e){this.getRequestBody=e;return n.apply(this,arguments)};return o};console.log("[WfHttp] xhr monitor start");if("undefined"==typeof XMLHttpRequest)console.log("[WfHttp] XMLHttpRequest not available");else{r=window.XMLHttpRequest;var n=XMLHttpRequest.prototype.send,i=XMLHttpRequest.prototype.open;if(n&&i){r.getRequestConfig=[];window.XMLHttpRequest=o;console.log("[WfHttp] XMLHttpRequest override completed")}else console.log("[WfHttp] Tracing is not supported")}}catch(e){console.log("[WfHttp] Override XMLHttpRequest failed:",e.message)}}();console.log("[WfHttp] HTTP monitoring initialized successfully")}else console.log("[WfHttp] HTTP monitoring disabled")}catch(e){console.log("[WfHttp] Initialize failed:",e.message)}},recordHttp:function e(o){try{if(o&&o.url){console.log("[WfHttp] Manual record HTTP:",o);z(o)}else console.log("[WfHttp] Invalid http object")}catch(e){console.log("[WfHttp] Record HTTP failed:",e.message)}},getStatus:function e(){return{enabled:!!N.enableHttp,xhrOverridden:window.XMLHttpRequest!==r}}};e.exports&&(e.exports=n);window.WfHttp=n},function(e,o,t){l={uploadUrl:"",maxRetries:3,retryDelay:1e3,timeout:5e3,enableBatch:!0,maxBatchSize:10},n={IMAGE:"image",XHR:"xhr",JSONP:"jsonp"},r=[];var l,n,r,WfUpload={init:function e(o){if(o){l.uploadUrl=o.uploadUrl||l.uploadUrl;l.maxRetries=o.maxRetries||l.maxRetries;l.retryDelay=o.retryDelay||l.retryDelay;l.timeout=o.timeout||l.timeout;l.enableBatch=(void 0!==o.enableBatch?o:l).enableBatch;l.maxBatchSize=o.maxBatchSize||l.maxBatchSize}},send:s,sendBatch:function e(o,t){if(!m(o)||0===o.length)return y("Invalid data array for batch upload"),!1;if(o.length>l.maxBatchSize){for(var n=[],r=0;r<o.length;r+=l.maxBatchSize)n.push(o.slice(r,r+l.maxBatchSize));for(var i=!0,a=0;a<n.length;a++)i=s(n[a],t)&&i;return i}return s(o,t)},flushRetryQueue:function e(){for(;0<r.length;)d()},getRetryQueueStatus:function e(){return{length:r.length,oldest:0<r.length?r[0].timestamp:null}},clearRetryQueue:function e(){r=[]},getMethods:function e(){return n},test:function e(o){return s({test:!0,timestamp:(new Date).getTime(),userAgent:navigator.userAgent||""},{uploadUrl:o,onSuccess:function e(){console.log("[WfUpload] Test successful")},onError:function e(o){console.error("[WfUpload] Test failed:",o)}})}};function s(e,o){try{var t=w(o),n=t.uploadUrl||l.uploadUrl;return n?e?u(function e(o){try{var t={sdkVersion:"1.0.0-ie8",timestamp:(new Date).getTime(),userAgent:navigator.userAgent||""};return m(o)?o.map(function(e){return p(e,t)}):p(o,t)}catch(e){y("_preprocessData error: "+e.message);return o}}(e),n,t):(y("Data is required for upload"),!1):(y("Upload URL is required"),!1)}catch(e){y("Upload error: "+e.message);return!1}}function i(e,o,t){try{var n=function e(o){try{return g({data:JSON.stringify(o),count:o.length,timestamp:(new Date).getTime()})}catch(e){y("_buildArrayQueryString error: "+e.message);return""}}(m(e)?e:[e]),r=o+"?"+n;if(2e3<r.length)return y("URL too long for Image upload: "+r.length),!1;var i=new Image,a=!1,s=setTimeout(function(){if(!a){a=!0;t.onError&&t.onError(new Error("Upload timeout"));f(e,o,t)}},t.timeout||l.timeout);i.onload=function(){if(!a){a=!0;clearTimeout(s);t.onSuccess&&t.onSuccess()}};i.onerror=function(){if(!a){a=!0;clearTimeout(s);t.onError&&t.onError(new Error("Image upload failed"));f(e,o,t)}};window.console&&window.console.log&&window.console.log("[WfUpload] Image\u8bf7\u6c42\u53d1\u8d77: "+r.substring(0,200)+(200<r.length?"...":""));i.src=r;return!0}catch(e){y("_uploadByImage error: "+e.message);return!1}}function a(e,o,t){try{var n=function e(o){try{if(window.XDomainRequest&&c(o))return window.console&&window.console.log&&window.console.log("[WfUpload] \u4f7f\u7528IE8\u7684XDomainRequest\u8fdb\u884c\u8de8\u57df\u8bf7\u6c42"),new window.XDomainRequest;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if(void 0!==window&&void 0!==window.ActiveXObject)try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){try{return new window.ActiveXObject("Msxml2.XMLHTTP")}catch(e){}}return null}catch(e){return null}}(o);if(!n)return window.console&&window.console.log&&window.console.log("[WfUpload] \u65e0\u6cd5\u521b\u5efaXHR\u5bf9\u8c61"),!1;var r=!1,i="",a="POST",s=void 0!==window.XDomainRequest&&n&&n.toString&&-1!==n.toString().indexOf("XDomainRequest")||n&&n.constructor&&"XDomainRequest"===n.constructor.name||n&&void 0!==n.onload&&void 0!==n.onerror&&void 0!==n.ontimeout&&!n.setRequestHeader,i=m(e)?JSON.stringify(e):JSON.stringify([e]),u=setTimeout(function(){if(!r){r=!0;n.abort&&n.abort();t.onError&&t.onError(new Error("XHR timeout"));f(e,o,t)}},t.timeout||l.timeout);if(s){window.console&&window.console.log&&window.console.log("[WfUpload] \u4f7f\u7528XDomainRequest\u53d1\u9001\u8bf7\u6c42");n.onload=function(){if(!r){r=!0;clearTimeout(u);t.onSuccess&&t.onSuccess(n.responseText)}};n.onerror=function(){if(!r){r=!0;clearTimeout(u);t.onError&&t.onError(new Error("XDomainRequest failed"));f(e,o,t)}};n.ontimeout=function(){if(!r){r=!0;clearTimeout(u);t.onError&&t.onError(new Error("XDomainRequest timeout"));f(e,o,t)}};if(window.console&&window.console.log){window.console.log("[WfUpload] XDomainRequest\u8bf7\u6c42\u53d1\u8d77: POST "+o);window.console.log("[WfUpload] XDomainRequest\u6570\u636e: "+i.substring(0,200)+(200<i.length?"...":""))}n.open(a,o)}else{window.console&&window.console.log&&window.console.log("[WfUpload] \u4f7f\u7528\u6807\u51c6XMLHttpRequest\u53d1\u9001\u8bf7\u6c42");n.onreadystatechange=function(){if(4===n.readyState&&!r){r=!0;clearTimeout(u);if(200<=n.status&&n.status<300)t.onSuccess&&t.onSuccess(n.responseText);else{t.onError&&t.onError(new Error("XHR failed with status: "+n.status));f(e,o,t)}}};if(window.console&&window.console.log){window.console.log("[WfUpload] XMLHttpRequest\u8bf7\u6c42\u53d1\u8d77: POST "+o);window.console.log("[WfUpload] XMLHttpRequest\u6570\u636e: "+i.substring(0,200)+(200<i.length?"...":""))}n.open(a,o,!0);n.setRequestHeader("Content-Type","application/json")}n.send(i);return!0}catch(e){window.console&&window.console.log&&window.console.log("[WfUpload] _uploadByXHR\u5f02\u5e38: "+e.message);y("_uploadByXHR error: "+e.message);return!1}}function c(e){try{var o,t;return e?(o=window.location,!!(t=e.match(/^https?:\/\/([^/]+)/))&&t[1]!==o.host):!1}catch(e){return!1}}function u(o,t,n){try{if(window.console&&window.console.log){window.console.log("[WfUpload] \u5f00\u59cb\u4e0a\u4f20\u6570\u636e\u5230: "+t);window.console.log("[WfUpload] \u6570\u636e\u5185\u5bb9: "+JSON.stringify(o).substring(0,300)+"...")}window.console&&window.console.log&&window.console.log("[WfUpload] \u5c1d\u8bd5XHR\u65b9\u5f0f\u4e0a\u4f20");if(c(t)&&window.XDomainRequest){window.console&&window.console.log&&window.console.log("[WfUpload] \u68c0\u6d4b\u5230\u8de8\u57df\u8bf7\u6c42\uff0c\u5c06\u4f7f\u7528XDomainRequest\uff0c\u5982\u679c\u5931\u8d25\u5219\u964d\u7ea7\u5230Image");var e=w(n),r=e.onError;e.onError=function(e){window.console&&window.console.log&&window.console.log("[WfUpload] XDomainRequest\u5931\u8d25\uff0c\u5c1d\u8bd5Image\u65b9\u5f0f: "+(e?e.message:"Unknown error"));if(!i(o,t,{onSuccess:n.onSuccess,onError:function e(o){window.console&&window.console.log&&window.console.log("[WfUpload] Image\u65b9\u5f0f\u4e5f\u5931\u8d25\u4e86: "+(o?o.message:"Unknown error"));r&&r(o)}})){window.console&&window.console.log&&window.console.log("[WfUpload] \u6240\u6709\u4e0a\u4f20\u65b9\u5f0f\u90fd\u5931\u8d25\u4e86");r&&r(e)}};if(a(o,t,e))return window.console&&window.console.log&&window.console.log("[WfUpload] XDomainRequest\u8bf7\u6c42\u5df2\u53d1\u8d77"),!0;window.console&&window.console.log&&window.console.log("[WfUpload] XDomainRequest\u521b\u5efa\u5931\u8d25\uff0c\u76f4\u63a5\u4f7f\u7528Image\u65b9\u5f0f")}else if(a(o,t,n))return window.console&&window.console.log&&window.console.log("[WfUpload] XHR\u65b9\u5f0f\u4e0a\u4f20\u6210\u529f"),!0;if(!0){window.console&&window.console.log&&window.console.log("[WfUpload] XHR\u65b9\u5f0f\u5931\u8d25\uff0c\u5c1d\u8bd5Image\u65b9\u5f0f");y("XHR upload failed, trying Image");if(i(o,t,n))return window.console&&window.console.log&&window.console.log("[WfUpload] Image\u65b9\u5f0f\u4e0a\u4f20\u6210\u529f"),!0}window.console&&window.console.log&&window.console.log("[WfUpload] \u6240\u6709\u4e0a\u4f20\u65b9\u5f0f\u90fd\u5931\u8d25\u4e86");y("All upload methods failed");return!1}catch(e){window.console&&window.console.log&&window.console.log("[WfUpload] \u4e0a\u4f20\u8fc7\u7a0b\u51fa\u9519: "+e.message);y("_executeUpload error: "+e.message);return!1}}function f(e,o,t){try{var n=t.retryCount||0;if(n<(t.maxRetries||l.maxRetries)){r.push({data:e,url:o,options:p(t,{retryCount:n+1}),timestamp:(new Date).getTime()});setTimeout(function(){d()},(t.retryDelay||l.retryDelay)*Math.pow(2,n))}else y("Upload failed after "+n+" retries")}catch(e){y("_handleUploadFailure error: "+e.message)}}function d(){try{if(0!==r.length){var e=r.shift();3e5<(new Date).getTime()-e.timestamp?y("Retry item expired, skipping"):u(e.data,e.url,e.options)}}catch(e){y("_processRetryQueue error: "+e.message)}}function g(e){try{if("undefined"!=typeof window&&void 0!==window.WfUtils&&window.WfUtils.toQueryString)return window.WfUtils.toQueryString(e);var o,t=[];for(o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var n=e[o];null!=n&&t.push(encodeURIComponent(o)+"="+encodeURIComponent(n))}return t.join("&")}catch(e){y("_buildQueryString error: "+e.message);return""}}function m(e){return"[object Array]"===Object.prototype.toString.call(e)}function w(e){return p({method:n.XHR,timeout:l.timeout,maxRetries:l.maxRetries,retryDelay:l.retryDelay,retryCount:0},e||{})}function p(e,o){var t,n,r={};for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(r[n]=o[n]);return r}function y(e){if("undefined"!=typeof console&&console.error)try{console.error("[WfUpload] "+e)}catch(e){}}"undefined"!=typeof window&&(window.WfUpload=WfUpload);e.exports?e.exports=WfUpload:"undefined"!=typeof window&&"function"==typeof window.define&&window.define.amd&&window.define(function(){return WfUpload})},function(e,o,t){a={maxQueueSize:100,batchSize:10,flushInterval:3e3,maxRetries:3,enableAutoFlush:!0},r=n=null,u=i=!(s=[]);var a,s,n,r,i,u,WfQueue={init:function e(o,t){try{if(o){a.maxQueueSize=o.maxQueueSize||a.maxQueueSize;a.batchSize=o.batchSize||a.batchSize;a.flushInterval=o.flushInterval||a.flushInterval;a.maxRetries=o.maxRetries||a.maxRetries;a.enableAutoFlush=(void 0!==o.enableAutoFlush?o:a).enableAutoFlush}t&&(r=t);!function e(){try{if(!u){if(window.attachEvent){window.attachEvent("onbeforeunload",d);window.attachEvent("onunload",d)}else if(window.addEventListener){window.addEventListener("beforeunload",d,!1);window.addEventListener("unload",d,!1)}else{window.onbeforeunload=d;window.onunload=d}u=!0}}catch(e){w("_bindUnloadEvent error: "+e.message)}}();setInterval(g,6e4);i=!0;m("Queue manager initialized")}catch(e){w("init error: "+e.message)}},add:function e(o,t){try{console.log("[WfQueue] \u6dfb\u52a0\u6570\u636e\u5230\u961f\u5217\uff0c\u5f53\u524d\u961f\u5217\u957f\u5ea6:",s.length);if(!o){console.log("[WfQueue] \u6570\u636e\u4e3a\u7a7a\uff0c\u6dfb\u52a0\u5931\u8d25");w("Data is required for queue");return!1}if(s.length>=a.maxQueueSize){console.log("[WfQueue] \u961f\u5217\u5df2\u6ee1\uff0c\u5f3a\u5236\u53d1\u9001\u3002\u961f\u5217\u957f\u5ea6:",s.length,"\u6700\u5927\u9650\u5236:",a.maxQueueSize);w("Queue is full, forcing flush");f()}var n={data:o,timestamp:(new Date).getTime(),retryCount:0,options:t||{}};s.push(n);console.log("[WfQueue] \u6570\u636e\u5df2\u6dfb\u52a0\u5230\u961f\u5217\uff0c\u65b0\u961f\u5217\u957f\u5ea6:",s.length);console.log("[WfQueue] \u6dfb\u52a0\u7684\u6570\u636e:",o);if(a.enableAutoFlush){console.log("[WfQueue] \u81ea\u52a8\u53d1\u9001\u5df2\u542f\u7528\uff0c\u68c0\u67e5\u662f\u5426\u9700\u8981\u53d1\u9001");l()}else console.log("[WfQueue] \u81ea\u52a8\u53d1\u9001\u5df2\u7981\u7528");return!0}catch(e){console.log("[WfQueue] addToQueue\u5f02\u5e38:",e.message);w("addToQueue error: "+e.message);return!1}},flush:function e(){try{f()}catch(e){w("flush error: "+e.message)}},pause:function e(){try{a.enableAutoFlush=!1;if(n){clearTimeout(n);n=null}m("Queue paused")}catch(e){w("pause error: "+e.message)}},resume:function e(){try{a.enableAutoFlush=!0;0<s.length&&l();m("Queue resumed")}catch(e){w("resume error: "+e.message)}},clear:function e(){try{s=[];if(n){clearTimeout(n);n=null}m("Queue cleared")}catch(e){w("clear error: "+e.message)}},getStatus:function e(){try{var o=function e(){try{var o={length:s.length,oldestTimestamp:0,newestTimestamp:0,totalRetries:0};if(0<s.length){var t=s.map(function(e){return e.timestamp});o.oldestTimestamp=Math.min.apply(Math,t);o.newestTimestamp=Math.max.apply(Math,t);o.totalRetries=s.reduce(function(e,o){return e+o.retryCount},0)}return o}catch(e){w("_getQueueStats error: "+e.message);return{length:0,oldestTimestamp:0,newestTimestamp:0,totalRetries:0}}}();return{initialized:i,autoFlushEnabled:a.enableAutoFlush,queueLength:o.length,oldestItem:o.oldestTimestamp,newestItem:o.newestTimestamp,totalRetries:o.totalRetries,hasTimer:null!==n}}catch(e){w("getStatus error: "+e.message);return{initialized:!1,autoFlushEnabled:!1,queueLength:0,oldestItem:0,newestItem:0,totalRetries:0,hasTimer:!1}}},setUploader:function e(o){r=o},updateConfig:function e(o){try{if(o){for(var t in o)Object.prototype.hasOwnProperty.call(o,t)&&Object.prototype.hasOwnProperty.call(a,t)&&(a[t]=o[t]);m("Config updated")}}catch(e){w("updateConfig error: "+e.message)}}};function l(){try{s.length>=a.batchSize?c():!n&&0<s.length&&(n=setTimeout(function(){c()},a.flushInterval))}catch(e){w("_checkAutoFlush error: "+e.message)}}function c(){try{console.log("[WfQueue] _flushQueue \u5f00\u59cb\uff0c\u5f53\u524d\u961f\u5217\u957f\u5ea6:",s.length);if(n){clearTimeout(n);n=null;console.log("[WfQueue] \u5df2\u6e05\u9664\u5b9a\u65f6\u5668")}if(0===s.length)console.log("[WfQueue] \u961f\u5217\u4e3a\u7a7a\uff0c\u65e0\u9700\u53d1\u9001");else if(r){console.log("[WfQueue] \u51c6\u5907\u53d1\u9001\u6570\u636e\uff0c\u6279\u91cf\u5927\u5c0f:",a.batchSize);var t=s.splice(0,a.batchSize),e=t.map(function(e){return e.data});console.log("[WfQueue] \u53d6\u51fa",t.length,"\u6761\u6570\u636e\u51c6\u5907\u53d1\u9001");console.log("[WfQueue] \u5269\u4f59\u961f\u5217\u957f\u5ea6:",s.length);console.log("[WfQueue] \u53d1\u9001\u7684\u6570\u636e:",e);var o={onSuccess:function e(){console.log("[WfQueue] \u4e0a\u4f20\u6210\u529f\u56de\u8c03");!function e(o){try{m("Successfully uploaded "+o.length+" items")}catch(e){w("_onUploadSuccess error: "+e.message)}}(t)},onError:function e(o){console.log("[WfQueue] \u4e0a\u4f20\u5931\u8d25\u56de\u8c03:",o?o.message:"Unknown error");!function e(o,t){try{w("Upload failed: "+(t?t.message:"Unknown error"));for(var n=[],r=0;r<o.length;r++){var i=o[r];if(i.retryCount<a.maxRetries){i.retryCount++;n.push(i)}else w("Item exceeded max retries, dropping")}if(0<n.length){s=n.concat(s);setTimeout(function(){a.enableAutoFlush&&l()},1e3*Math.pow(2,n[0].retryCount))}}catch(e){w("_onUploadError error: "+e.message)}}(t,o)}};if(1<e.length){console.log("[WfQueue] \u4f7f\u7528\u6279\u91cf\u4e0a\u4f20\uff0c\u6570\u636e\u6761\u6570:",e.length);r.sendBatch(e,o)}else if(1===e.length){console.log("[WfQueue] \u4f7f\u7528\u5355\u6761\u4e0a\u4f20");r.send(e[0],o)}if(0<s.length&&a.enableAutoFlush){console.log("[WfQueue] \u8fd8\u6709\u5269\u4f59\u6570\u636e\uff0c\u7ee7\u7eed\u5904\u7406");l()}}else{console.log("[WfQueue] \u4e0a\u4f20\u5668\u672a\u914d\u7f6e");w("Uploader not configured")}}catch(e){console.log("[WfQueue] _flushQueue\u5f02\u5e38:",e.message);w("_flushQueue error: "+e.message)}}function f(){try{for(;0<s.length;)c()}catch(e){w("_forceFlush error: "+e.message)}}function d(){try{f();r&&r.flushRetryQueue&&r.flushRetryQueue()}catch(e){w("_handlePageUnload error: "+e.message)}}function g(){try{var o=(new Date).getTime();s=s.filter(function(e){return o-e.timestamp<3e5})}catch(e){w("_cleanupQueue error: "+e.message)}}function m(e){if("undefined"!=typeof console&&console.log)try{console.log("[WfQueue] "+e)}catch(e){}}function w(e){if("undefined"!=typeof console&&console.error)try{console.error("[WfQueue] "+e)}catch(e){}}"undefined"!=typeof window&&(window.WfQueue=WfQueue);e.exports?e.exports=WfQueue:"undefined"!=typeof window&&"function"==typeof window.define&&window.define.amd&&window.define(function(){return WfQueue})}]);